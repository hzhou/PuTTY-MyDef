include: c_hash.def

subcode:: _autoload
    $global struct hash * p_config

subcode: init_config
    p_config=hash_new(200)

subcode: get_config(name, var, default)
    $call assert, p_config
    ts_temp=hash_getstr(p_config, $(name))
    tn_ret=0
    $if ts_temp
	$eval str2var, $(var)
    $if tn_ret==0
	$(var)=$(default)

perlcode: str2var
    my $fmt=get_var_fmt($param)
    func_add_var("tn_ret", "int")
    push @$out, "tn_ret=sscanf(ts_temp, \"$fmt\", \&$param);"

